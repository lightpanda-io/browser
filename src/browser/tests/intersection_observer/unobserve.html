<!DOCTYPE html>
<script src="../testing.js"></script>
<div id="target1" style="width: 100px; height: 100px;">Target 1</div>
<div id="target2" style="width: 100px; height: 100px;">Target 2</div>

<script id="unobserve">
    const target1 = document.getElementById('target1');
    const target2 = document.getElementById('target2');
    const seenTargets = [];

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            seenTargets.push(entry.target);
        });
    });

    // Observe target1, unobserve it, then observe target2
    // We should only get a callback for target2
    observer.observe(target1);
    observer.unobserve(target1);
    observer.observe(target2);

    testing.eventually(() => {
        // Should only see target2, not target1
        testing.expectEqual(1, seenTargets.length);
        testing.expectEqual(target2, seenTargets[0]);

        observer.disconnect();
    });
</script>
